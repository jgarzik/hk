# Dell Optiplex 3020 configuration
# - Graphics console via GOP framebuffer (no serial port on this machine)

# Start with text console as fallback
terminal_output console

# Try to load video drivers
insmod all_video
insmod gfxterm

# Conservative video modes (try lower resolutions first)
set gfxmode=1024x768x32,800x600x32,auto
set gfxpayload=keep

# Try to switch to graphics terminal (falls back to console if it fails)
terminal_output gfxterm

# Show menu for debugging (set to 0 after it works)
set timeout=5
set default=0

insmod multiboot2

menuentry "hk kernel" {
    echo "Loading kernel..."
    multiboot2 /boot/kernel root=/dev/ram0
    module2 /boot/initramfs.cpio initramfs
    module2 /boot/vfat.img vfat
    echo "Booting..."
    boot
}

menuentry "hk kernel (text mode)" {
    terminal_output console
    set gfxpayload=text
    echo "Loading kernel (text mode)..."
    multiboot2 /boot/kernel root=/dev/ram0
    module2 /boot/initramfs.cpio initramfs
    module2 /boot/vfat.img vfat
    echo "Booting..."
    boot
}
